<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Gira la Ruota - GiankyBot (Test)</title>
  <style>
    body { text-align: center; font-family: sans-serif; padding: 20px; }
    canvas { border: 1px solid #000; margin: 20px auto; display: block; }
    button { padding: 10px 20px; font-size: 1rem; cursor: pointer; }
  </style>
  <!-- Carica TweenMax (necessario per Winwheel.js) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js"></script>
</head>
<body>
  <h1>Test Ruota</h1>
  <canvas id="canvas" width="500" height="500"></canvas>
  <br>
  <button id="spinButton">Gira la ruota</button>
  <!-- Carica Winwheel.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Winwheel.js/2.7.0/Winwheel.min.js"></script>
  <script>
    const prizeData = [
      { text: '10 GKY', color: '#F1C40F' },
      { text: '20 GKY', color: '#FF8C00' },
      { text: '50 GKY', color: '#E67E22' },
      { text: '100 GKY', color: '#E74C3C' },
      { text: '250 GKY', color: '#9B59B6' },
      { text: '500 GKY', color: '#3498DB' },
      { text: '1000 GKY', color: '#1ABC9C' },
      { text: 'NO PRIZE', color: '#C0392B' },
      { text: 'NO PRIZE', color: '#BDC3C7' },
      { text: 'NO PRIZE', color: '#BDC3C7' }
    ];
    const segments = prizeData.map(item => ({
      fillStyle: item.color,
      text: item.text
    }));
    function createWheel(finalAngle) {
      return new Winwheel({
        canvasId: 'canvas',
        numSegments: segments.length,
        outerRadius: 200,
        segments: segments,
        animation: {
          type: 'spinToStop',
          duration: 5,
          spins: 8,
          stopAngle: finalAngle,
          callbackFinished: function(indicatedSegment) {
            alert("Hai vinto: " + indicatedSegment.text);
          }
        }
      });
    }
    document.getElementById("spinButton").addEventListener("click", () => {
      const chosenIndex = Math.floor(Math.random() * segments.length);
      const anglePerSegment = 360 / segments.length;
      const stopAngleCenter = (chosenIndex * anglePerSegment) + (anglePerSegment / 2);
      const extraSpins = 360 * 5;
      const finalAngle = (360 - stopAngleCenter) + extraSpins;
      const wheel = createWheel(finalAngle);
      wheel.startAnimation();
    });
  </script>
</body>
</html>
