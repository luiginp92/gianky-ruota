<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Collega il tuo Wallet - GiankyCoin</title>
  <!-- Disabilita cache -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css?v=1.0.0">
  <!-- Ethers.js UMD -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <!-- Web3Modal e WalletConnect Provider (UMD) -->
  <script src="https://unpkg.com/web3modal@1.9.8/dist/index.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
  <style>
    body { background-color: #f8f9fa; padding-top: 50px; }
    .container { max-width: 500px; }
    .alert-deep { margin-top: 20px; }
  </style>
</head>
<body>
  <div class="container text-center">
    <h1 class="mb-4">Collega il tuo Wallet</h1>
    <p>Per completare il collegamento, ti invitiamo ad aprire questa pagina in un browser esterno.</p>
    <button id="openExternalButton" class="btn btn-secondary btn-lg">Apri in Browser Esterno</button>
    <div id="message" class="mt-3"></div>
  </div>
  
  <script>
    // Funzione per rilevare se si sta usando il browser integrato di Telegram o simili
    function isInAppBrowser() {
      const ua = navigator.userAgent || navigator.vendor || window.opera;
      // Rileva Telegram o altri browser in-app
      return ua.includes("Telegram") || ua.includes("FBAN") || ua.includes("FBAV");
    }

    // Se rileviamo un ambiente in-app, mostra il pulsante per aprire in browser esterno
    if (isInAppBrowser()) {
      document.getElementById("openExternalButton").style.display = "inline-block";
    } else {
      // Se non sei in un ambiente in-app, reindirizza automaticamente al flusso di connessione
      window.location.href = "/static/connect_flow.html";
    }
  </script>
</body>
</html>
